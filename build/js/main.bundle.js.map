{"version":3,"sources":["webpack://keksobooking/./source/js/card.js","webpack://keksobooking/./source/js/form-activation.js","webpack://keksobooking/./source/js/map.js","webpack://keksobooking/./source/js/api.js","webpack://keksobooking/./source/js/util.js","webpack://keksobooking/./source/js/popup.js","webpack://keksobooking/./source/js/map-filters.js","webpack://keksobooking/./source/js/form.js","webpack://keksobooking/./source/js/data.js","webpack://keksobooking/./source/js/photo.js"],"names":["document","querySelector","content","housingType","flat","bungalow","house","palace","mapFiltersForm","mainForm","selects","querySelectorAll","fieldsets","classList","add","addDisabled","element","disabled","removeDisabled","forEach","L","window","TOKIO_CENTER_LAT","TOKIO_CENTER_LNG","address","markerGroup","layerGroup","map","on","remove","setView","lat","lng","tileLayer","attribution","addTo","mainPinIcon","icon","iconUrl","iconSize","iconAnchor","secondPinIcon","mainMarker","marker","draggable","locationPoint","getLatLng","fillingPopupMarkers","allOffers","clearLayers","slice","oneOffer","secondMarker","location","bindPopup","item","cloneTemplate","cloneNode","popupAvatar","popupTitle","popupAdress","popupPrice","popupType","popupCapacity","popupTime","popupDescription","popupFeatures","popupPhotos","guests","rooms","src","author","avatar","textContent","offer","title","price","type","checkin","checkout","description","list","features","innerHTML","i","length","featuresItem","createElement","appendChild","createFeatures","photos","photosItem","className","width","height","alt","createFhotos","createCard","addLayer","value","evt","targetLatLng","target","toFixed","resetMainMarker","setLatLng","load","url","method","headers","Headers","body","fetch","then","response","ok","json","Error","getData","onSuccess","onError","catch","isEscEvent","key","main","successMessage","errorMessage","closePopup","message","escFoo","removeEventListener","onPopupErrorShow","addEventListener","onPopupErrorEsc","onPopupErrorClick","preventDefault","onPopupSuccessEsc","onPopupSuccessClick","mapFilterForm","housingPrice","housingRooms","housingGuests","checkType","ending","toString","checkAllFilters","checkPrice","checkboxs","itemFeatures","chek","includes","checkFeatures","filtringTypeHousing","hotels","_","debounce","filter","typeHousing","priceHousing","timeIn","timeOut","roomNumber","guestNumber","guestNumberOptions","Array","from","options","titleInput","priseInput","roomsToGuestsNumber","1","2","3","100","housingToPrice","disabledGuestOption","option","selected","checkTitleInputValidity","valueLength","validity","tooShort","setCustomValidity","tooLong","valueMissing","reportValidity","checkPriseInputValidity","rangeUnderflow","min","rangeOverflow","placeholder","sendSuccess","reset","data","FormData","FILES_TYPE","avatarInput","avatarPreview","housingInput","housingPreview","style","minWidth","marginTop","showUserPhotos","input","preview","funct","file","files","fileType","toLowerCase","some","it","endsWith","reader","FileReader","readAsDataURL","result"],"mappings":"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","file":"main.bundle.js","sourcesContent":["const element = document.querySelector('#card').content.querySelector('.popup');\n\nconst createFeatures = (list, features) => {\n  list.innerHTML = '';\n  for (let i = 0; i < features.length; i++) {\n    const featuresItem = document.createElement('li');\n    featuresItem.classList.add('popup__feature', `popup__feature--${features[i]}`);\n    list.appendChild(featuresItem);\n  }\n};\n\nconst createFhotos = (list, photos) => {\n  list.innerHTML = '';\n  for (let i = 0; i < photos.length; i++) {\n    const photosItem = document.createElement('img');\n    photosItem.className = 'popup__photo';\n    photosItem.width = '45';\n    photosItem.height = '40';\n    photosItem.alt = 'Фотография жилья';\n    photosItem.src = photos[i];\n    list.appendChild(photosItem);\n  }\n};\n\nconst addRoomsDeclinations = (rooms) => {\n\n  if (rooms === 1) {\n    rooms += ' комната'\n  }\n  if (rooms > 1 && rooms < 5) {\n    rooms += ' комнаты'\n  }\n  if (rooms >= 5 && rooms < 20) {\n    rooms += ' комнат'\n  }\n\n  return rooms\n};\n\nconst addGuestsDeclinations = (guests) => {\n\n  if (guests === 1) {\n    guests += ' гостя'\n  } else {\n    guests += ' гостей'\n  }\n\n  return guests\n};\n\nconst housingType = {\n  flat: 'Квартира',\n  bungalow: 'Бунгало',\n  house: 'Дом',\n  palace: 'Доврец',\n};\n\nconst createCard = (item) => {\n\n  const cloneTemplate = element.cloneNode(true);\n  const popupAvatar = cloneTemplate.querySelector('.popup__avatar');\n  const popupTitle = cloneTemplate.querySelector('.popup__title');\n  const popupAdress = cloneTemplate.querySelector('.popup__text--address');\n  const popupPrice = cloneTemplate.querySelector('.popup__text--price');\n  const popupType = cloneTemplate.querySelector('.popup__type');\n  const popupCapacity = cloneTemplate.querySelector('.popup__text--capacity');\n  const popupTime = cloneTemplate.querySelector('.popup__text--time');\n  const popupDescription = cloneTemplate.querySelector('.popup__description');\n  const popupFeatures = cloneTemplate.querySelector('.popup__features');\n  const popupPhotos = cloneTemplate.querySelector('.popup__photos');\n\n\n  popupAvatar.src = item.author.avatar;\n  popupTitle.textContent = item.offer.title;\n  popupAdress.textContent = item.offer.address;\n  popupPrice.textContent = item.offer.price + ' ₽/ночь';\n  popupType.textContent = housingType[item.offer.type];\n  popupCapacity.textContent = `${addRoomsDeclinations(item.offer.rooms)} для ${addGuestsDeclinations(item.offer.guests)}`;\n  popupTime.textContent = `Заезд после ${item.offer.checkin} выезд до ${item.offer.checkout}`;\n  popupDescription.textContent = item.offer.description;\n  createFeatures(popupFeatures, item.offer.features);\n  createFhotos(popupPhotos, item.offer.photos);\n\n  return cloneTemplate\n\n};\n\nexport {createCard};\n","//Активация и деактивация формы\nconst mapFiltersForm = document.querySelector('.map__filters');\nconst mainForm = document.querySelector('.ad-form');\nconst selects = mapFiltersForm.querySelectorAll('select');\nconst fieldsets = document.querySelectorAll('fieldset');\n\nmapFiltersForm.classList.add('ad-form--disabled');\nmainForm.classList.add('ad-form--disabled');\n\nconst addDisabled = (element) => {\n  element.disabled = true;\n};\n\nconst removeDisabled = (element) => {\n  element.disabled = false;\n};\n\nselects.forEach(addDisabled);\nfieldsets.forEach(addDisabled);\n\nconst activateForm = () => {\n  mapFiltersForm.classList.remove('ad-form--disabled');\n  mainForm.classList.remove('ad-form--disabled');\n  selects.forEach(removeDisabled);\n  fieldsets.forEach(removeDisabled);\n}\n\nexport {activateForm};\n","import { createCard } from './card.js';\nimport { activateForm } from './form-activation.js';\n\n\nconst L = window.L;\nconst TOKIO_CENTER_LAT = 35.68950;\nconst TOKIO_CENTER_LNG = 139.69171;\nconst MAP_SIZE = 9;\nconst MARKERS_NUMBER = 10;\nconst MAIN_ICON_SIZE = [52, 52];\nconst MAIN_ICON_ANCHOR = [26, 52];\nconst SECOND_ICON_SIZE = [40, 40];\nconst SECOND_ICON_ANCHOR = [20, 40];\nconst DOTS_AFTER_ZERO = 5;\n\nconst address = document.querySelector('#address');\n\nconst markerGroup = L.layerGroup();\n\nconst map = L.map('map-canvas')\n  .on('load', () => {\n    activateForm();\n  })\n  .setView({\n    lat: TOKIO_CENTER_LAT,\n    lng: TOKIO_CENTER_LNG,\n  }, MAP_SIZE)\n;\n\nL.tileLayer(\n  'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n  {\n    attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n  },\n).addTo(map);\n\nconst mainPinIcon = L.icon({\n  iconUrl: '/img/main-pin.svg',\n  iconSize: MAIN_ICON_SIZE,\n  iconAnchor: MAIN_ICON_ANCHOR,\n});\n\nconst secondPinIcon = L.icon({\n  iconUrl: '/img/pin.svg',\n  iconSize: SECOND_ICON_SIZE,\n  iconAnchor: SECOND_ICON_ANCHOR,\n});\n\nconst mainMarker = L.marker(\n  {\n    lat: TOKIO_CENTER_LAT,\n    lng: TOKIO_CENTER_LNG,\n  },\n  {\n    draggable: true,\n    icon: mainPinIcon,\n  },\n);\n\nconst locationPoint = mainMarker.getLatLng();\n\nconst fillingPopupMarkers = (allOffers) => {\n  markerGroup.clearLayers();\n  allOffers\n    .slice(0, MARKERS_NUMBER)\n    .forEach((oneOffer) => {\n      const secondMarker = L.marker(\n        {\n          lat: oneOffer.location.lat,\n          lng: oneOffer.location.lng,\n        },\n        {\n          icon: secondPinIcon,\n        },\n      );\n      secondMarker.bindPopup(createCard(oneOffer));\n      markerGroup.addLayer(secondMarker);\n    })\n};\n\nmarkerGroup.addTo(map)\nmainMarker.addTo(map);\n\naddress.value = `${locationPoint.lat}, ${locationPoint.lng}`\n\nmainMarker.on('move', (evt) => {\n  const targetLatLng = evt.target.getLatLng();\n\n  address.value = `${targetLatLng.lat.toFixed(DOTS_AFTER_ZERO)}, ${targetLatLng.lng.toFixed(DOTS_AFTER_ZERO)}`;\n});\n\nconst resetMainMarker = () => {\n  map.setView(\n    {\n      lat: TOKIO_CENTER_LAT,\n      lng: TOKIO_CENTER_LNG,\n    },\n    MAP_SIZE);\n  mainMarker.setLatLng(\n    {\n      lat: TOKIO_CENTER_LAT,\n      lng: TOKIO_CENTER_LNG,\n    },\n  );\n  address.value = `${TOKIO_CENTER_LAT}, ${TOKIO_CENTER_LNG}`\n};\n\n\nconst clearMarkerGroup = () => {\n  markerGroup.clearLayers();\n}\n\n\nexport {fillingPopupMarkers, resetMainMarker, clearMarkerGroup};\n","const END_POINT = 'https://22.javascript.pages.academy/keksobooking';\nconst Method = {\n  GET: 'GET',\n  POST: 'POST',\n}\n\nconst load = ({url, method = Method.GET, headers = new Headers(), body = null }) => {\n  return fetch(`${END_POINT}${url}`, {\n    method,\n    headers,\n    body,\n  })\n    .then((response) => {\n      if (response.ok) {\n        return response.json();\n      }\n      throw new Error('`${response.status}: ${response.statusText}`');\n    });\n}\n\nconst getData = (onSuccess, onError) => {\n  return load({url: '/data'})\n    .then(onSuccess)\n    .catch(onError)\n}\n\nconst postData = (onSuccess, onError, data) => {\n  return load({url: '', method: Method.POST, body: data})\n    .then(onSuccess)\n    .catch(onError)\n};\n\nexport {getData, postData};\n","//Заготовка для слушателя\nconst isEscEvent = (evt) => {\n  return evt.key === ('Escape' || 'Esc');\n};\n\nexport {isEscEvent};\n\n","import { isEscEvent } from './util.js';\n\n\n//Отправка данных\nconst main = document.querySelector('main');\nconst successMessage = document.querySelector('#success').content.querySelector('.success');\nconst errorMessage = document.querySelector('#error').content.querySelector('.error');\n\nconst closePopup = (message, escFoo) => {\n  message.remove();\n  document.removeEventListener('keydown', escFoo);\n}\n\n//Создание попапа ошибки формы\nconst onPopupErrorShow = () => {\n  document.addEventListener('keydown', onPopupErrorEsc);\n  errorMessage.querySelector('.error__message').textContent = 'Ошибка размещения объявления';\n  errorMessage.addEventListener('click', onPopupErrorClick);\n  main.appendChild(errorMessage);\n}\n//Обработка ESC на попапе ошибки\nconst onPopupErrorEsc = (evt) => {\n  if (isEscEvent(evt)) {\n    evt.preventDefault();\n    closePopup(errorMessage, onPopupErrorEsc);\n  }\n}\n//Удаление кликера\nconst onPopupErrorClick = () => {\n  closePopup(errorMessage, onPopupErrorEsc);\n  errorMessage.removeEventListener('click', onPopupErrorClick);\n}\n\n//Создание попапа успешной отправки формы\nconst onPopupSuccessShow = () => {\n  document.addEventListener('keydown', onPopupSuccessEsc);\n  successMessage.addEventListener('click', onPopupSuccessClick);\n  main.appendChild(successMessage);\n}\n//Обработка ESC на попапе успешной отправки формы\nconst onPopupSuccessEsc = (evt) => {\n  if (isEscEvent(evt)) {\n    evt.preventDefault();\n    closePopup(successMessage, onPopupSuccessEsc);\n  }\n}\n//Удаление кликера\nconst onPopupSuccessClick = () => {\n  closePopup(successMessage, onPopupSuccessEsc);\n  successMessage.removeEventListener('click', onPopupSuccessClick);\n}\n\n//Ошибка загрузки карты\nconst showMapErrorPopup = () => {\n  onPopupErrorShow();\n  errorMessage.querySelector('.error__message').textContent = 'Объявления не загрузились';\n}\n\nexport {onPopupErrorShow, onPopupSuccessShow, showMapErrorPopup};\n","/* global _:readonly */\nimport { getData } from './api.js';\nimport { fillingPopupMarkers, clearMarkerGroup } from './map.js';\n\nconst MIN_PRICE = 10000;\nconst MAX_PRICE = 50000;\nconst RERENDER_TIMEOUT = 500;\nconst DEFAULT_FILTER_VALUE = 'any';\n\nconst mapFilterForm = document.querySelector('.map__filters');\nconst housingType = mapFilterForm.querySelector('#housing-type');\nconst housingPrice = mapFilterForm.querySelector('#housing-price');\nconst housingRooms = mapFilterForm.querySelector('#housing-rooms');\nconst housingGuests = mapFilterForm.querySelector('#housing-guests');\n\nconst checkType = (item, ending, element) => {\n  if (element.value === DEFAULT_FILTER_VALUE) {\n    return true\n  }\n  return item.offer[ending].toString() === (element.value  || DEFAULT_FILTER_VALUE);\n}\n\nconst checkPrice = (item) => {\n  switch (housingPrice.value) {\n    case 'middle':\n      return item.offer.price <= MAX_PRICE && item.offer.price >= MIN_PRICE\n    case 'low':\n      return item.offer.price < MIN_PRICE\n    case 'high':\n      return item.offer.price > MAX_PRICE\n  }\n  return true;\n}\n\nconst checkFeatures = (item) => {\n  const checkboxs = mapFilterForm.querySelectorAll('input[type=\"checkbox\"]:checked');\n  const itemFeatures = item.offer.features;\n  if (!checkboxs.length) {\n    return true\n  }\n  for (let chek of checkboxs) {\n    if (!itemFeatures.includes(chek.value)) {\n      return false\n    }\n  }\n  return true\n}\n\nconst checkAllFilters = (item) => {\n  return checkType(item, 'type', housingType)\n  && checkType(item, 'rooms', housingRooms)\n  && checkType(item, 'guests', housingGuests)\n  && checkPrice(item)\n  && checkFeatures(item)\n}\n\nconst filtringTypeHousing = (hotels) => {\n  fillingPopupMarkers(hotels);\n\n  mapFilterForm.addEventListener('change', (_.debounce(() => {\n    clearMarkerGroup();\n    fillingPopupMarkers(hotels.filter(checkAllFilters))\n  }, RERENDER_TIMEOUT)\n  ))\n}\n\nconst resetFilter = () => {\n  mapFilterForm.reset();\n  getData(filtringTypeHousing);\n}\n\n\nexport {filtringTypeHousing, resetFilter}\n","import { resetMainMarker } from './map.js';\nimport { postData } from './api.js';\nimport { onPopupErrorShow, onPopupSuccessShow } from './popup.js';\nimport { resetFilter } from './map-filters.js';\n\n\nconst MIN_NAME_LENGTH = 30;\nconst MAX_NAME_LENGTH = 100;\n\nconst mainForm = document.querySelector('.ad-form');\n\nconst typeHousing = mainForm.querySelector('#type');\nconst priceHousing = mainForm.querySelector('#price');\n\nconst timeIn = mainForm.querySelector('#timein');\nconst timeOut = mainForm.querySelector('#timeout');\n\nconst roomNumber = mainForm.querySelector('#room_number');\nconst guestNumber = mainForm.querySelector('#capacity');\nconst guestNumberOptions = Array.from(guestNumber.options);\n\nconst titleInput = document.querySelector('#title');\nconst priseInput = document.querySelector('#price');\n\nconst roomsToGuestsNumber = {\n  1 : ['1'],\n  2 : ['1', '2'],\n  3 : ['1', '2', '3'],\n  100 : ['0'],\n}\n\nconst housingToPrice = {\n  bungalow: 0,\n  flat: 1000,\n  house: 5000,\n  palace: 10000,\n}\n\nconst disabledGuestOption = () => {\n  guestNumberOptions.forEach((option) => {\n    option.disabled = !roomsToGuestsNumber[roomNumber.value].includes(option.value);\n    option.selected = !option.disabled;\n  })\n}\ndisabledGuestOption();\n\nroomNumber.addEventListener('change', () => {\n  disabledGuestOption();\n})\n\nconst checkTitleInputValidity = () => {\n  const valueLength = titleInput.value.length;\n  if (titleInput.validity.tooShort) {\n    titleInput.setCustomValidity('Ещё ' + (MIN_NAME_LENGTH - valueLength) +' симв., бро!');\n  } else if (titleInput.validity.tooLong) {\n    titleInput.setCustomValidity('Удали лишние ' + (valueLength - MAX_NAME_LENGTH) +' симв., бро!');\n  } else if (titleInput.validity.valueMissing) {\n    titleInput.setCustomValidity('Обязательное поле, бро!');\n  } else {\n    titleInput.setCustomValidity('');\n  }\n}\n\ntitleInput.addEventListener('invalid', () => {\n  checkTitleInputValidity();\n});\n\ntitleInput.addEventListener('input', () => {\n  checkTitleInputValidity();\n  titleInput.reportValidity();\n});\n\nconst checkPriseInputValidity = () => {\n  if (priseInput.validity.valueMissing) {\n    priseInput.setCustomValidity('Обязательное поле, бро!');\n  } else if (priseInput.validity.rangeUnderflow) {\n    priseInput.setCustomValidity('Нужно больше золота! (' + priseInput.min + ')');\n  } else if (priseInput.validity.rangeOverflow) {\n    priseInput.setCustomValidity('Ну это тумач!');\n  } else {\n    priseInput.setCustomValidity('');\n  }\n}\n\npriseInput.addEventListener('invalid', () => {\n  checkPriseInputValidity();\n});\n\npriseInput.addEventListener('input', () => {\n  checkPriseInputValidity();\n  priseInput.reportValidity();\n});\n\ntypeHousing.addEventListener('change', () => {\n  let type = typeHousing.value;\n  priceHousing.placeholder = housingToPrice[type];\n  priceHousing.min = housingToPrice[type];\n})\n\ntimeIn.addEventListener('change', () => {\n  let type = timeIn.value;\n  timeOut.value = type;\n})\n\ntimeOut.addEventListener('change', () => {\n  let type = timeOut.value;\n  timeIn.value = type;\n})\n\n//Отправка данных\nconst sendSuccess = () => {\n  onPopupSuccessShow();\n  mainForm.reset();\n  resetFilter();\n  resetMainMarker();\n};\n\nmainForm.addEventListener('submit', (evt) => {\n  evt.preventDefault();\n  postData(sendSuccess, onPopupErrorShow, new FormData(evt.target));\n});\n\nmainForm.querySelector('.ad-form__reset').addEventListener('click', (evt) => {\n  evt.preventDefault();\n  mainForm.reset();\n  resetMainMarker();\n});\n\nexport {mainForm};\n","import { getData } from './api.js';\nimport { filtringTypeHousing } from './map-filters.js';\nimport { showMapErrorPopup } from './popup.js';\n\n\ngetData(filtringTypeHousing, showMapErrorPopup);\n","import { mainForm } from './form.js';\n\nconst FILES_TYPE = ['gif', 'jpg', 'jpeg', 'png'];\n\nconst avatarInput = mainForm.querySelector('#avatar');\nconst avatarPreview = mainForm.querySelector('.ad-form-header__preview').querySelector('img');\nconst housingInput = mainForm.querySelector('#images');\nconst housingPreview = mainForm.querySelector('.ad-form__photo');\n\nhousingPreview.style.width = 'auto';\nhousingPreview.style.minWidth = '70px';\nhousingPreview.style.marginTop = '2px';\n\nconst showAvatar = (evt, preview) => {\n  preview.src = evt.target.result;\n}\n\nconst showHousePhoto = (evt, preview) => {\n  const photosItem = document.createElement('img');\n  photosItem.className = 'popup__photo';\n  photosItem.width = '70';\n  photosItem.alt = 'Фотография жилья';\n  photosItem.src = evt.target.result;\n  preview.appendChild(photosItem);\n}\n\nconst showUserPhotos = (input, preview, funct) => {\n  input.addEventListener('change', (evt) => {\n    const file = evt.target.files[0];\n    const fileType = file.type.toLowerCase();\n\n    const conformity = FILES_TYPE.some((it) => {\n      return fileType.endsWith(it)\n    });\n\n    if (conformity) {\n      const reader = new FileReader();\n\n      reader.addEventListener('load', (evt) => {\n        funct(evt, preview);\n      });\n\n      reader.readAsDataURL(file);\n    }\n  });\n}\n\nshowUserPhotos(avatarInput, avatarPreview, showAvatar)\nshowUserPhotos(housingInput, housingPreview, showHousePhoto)\n\n"],"sourceRoot":""}